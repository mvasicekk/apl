<div id="spinner"></div>

<div class="container-fluid">
    <div class="page-header">
	<h4>S360 (interaktiv)</h4>
    </div>
<!--    <div>
	{{showGroups|json}}
    </div>-->
<table ng-init="columns=14" id='d550it' st-table="dZeilen" st-safe-src="zeilen" class="table table-bordered table-striped table-condensed table-hover table-responsive">
	<thead>
	    <tr class="no-print">
		<th colspan="{{columns}}">
		    <div style="display:inline-block;">
			<input tabindex="1" style="width:8em;" class="form-control" ng-keypress="getZeilen($event)" maxlength="5" ng-model="kundeVon" placeholder="Kunde von" type="text"/>
			<input tabindex="2" style="width:8em;" class="form-control" ng-keypress="getZeilen($event)" maxlength="5" ng-model="kundeBis" placeholder="Kunde bis" type="text"/>
		    </div>
		    <div style="display:inline-block;">
			<input tabindex="3" ng-model="reklVon" style="width:8em;" ui-date="dateOptions" type="text" class="form-control" id="" placeholder="Erhalten von">
			<input tabindex="4" ng-model="reklBis" style="width:8em;" ui-date="dateOptions" type="text" class="form-control" id="" placeholder="Erhalten bis">
		    </div>
		    <div style="display:inline-block;">
			<input tabindex="5" style="width:8em;" class="form-control" ng-keypress="getZeilen($event)" maxlength="8" ng-model="reklnr" placeholder="ReklNr" type="text"/>
		    </div>
		    <div style="display:inline-block;vertical-align:top;">
		    <label class="radio-inline">
			<input ng-model="wahrung" type="radio" name="wahrungRadioOptions" id="inlineRadio1" value="EUR"> EUR
		    </label>
		    <label class="radio-inline">
			<input ng-model="wahrung" type="radio" name="wahrungRadioOptions" id="inlineRadio2" value="CZK"> CZK
		    </label>
		    </div>
		    <div style="display:inline-block;">
			<button class="btn btn-primary no-print" ng-click="showPrintDialog()">drucken</button>
		    </div>
		    <div style="display:inline-block;vertical-align: top;width:40em;">
			<input ng-model-options="{ updateOn: 'default blur', debounce: { 'default': 500, 'blur': 0 }}" type="text" class="form-control" placeholder="global Suche / glob. hledani" ng-model="globalsearch"/>
		    </div>
		</th>
	    </tr>
	    <tr>
		<th>
		    ReklNr<hr>
		    Kd.Rekl
		</th>
		<th>Auftrag</th>
		<th>
		<div class="checkbox no-print">
		<label>
		    <input type="checkbox" ng-model="filter_nichterledigt">
		    nicht erledigt
		    </label>
		</div>
		    Erhalten am<hr>
		    Erledigt am
		</th>
		<th>Abweichung</th>
		<th>Ursache</th>
		<th>Art der Beseitigung</th>
		<th>
		    Teil<hr>
		    Giesstag
		</th>
		<th class="text-right">Stk exp.</th>
		<th class="text-right">Stk rekl.</th>
		<th class="text-right">Bew.</th>
		<th style="width:8em;" class="text-right">
		    <div class="row rowstk">
			<div class="col-xs-6 text-left">Typ</div>
			<div class="col-xs-6 text-right">Stk</div>
		    </div>
		</th>
		<th class="text-right">Kosten[{{wahrung}}]</th>
		<th class="text-right">Abmahn. Betrag [CZK]</th>
		<th>Bemerkung</th>
	    </tr>
	</thead>
	<tbody ng-if="zeilen===null">
	    <tr>
		<td colspan="{{columns}}" class="text-center text-danger">
		    <h1>Keine Data !</h1>
		</td>
	    </tr>
	</tbody>
	<tbody>
	    <tr class="{{r.section}}" ng-repeat="r in dZeilen|filter:globalsearch" ng-init="zeilenIndex = $index">
		
		<!--kundeheader------------------------------------------------> 
		<td colspan="{{columns-5}}" class="{{r.section}}" ng-if="r.section=='kundeheader'">
		    {{r.kunde}}
		</td>
		<td colspan="{{1}}" class="{{r.section}} text-right" ng-if="r.section=='kundeheader'">
		    {{r.summen.interne_bewertung}}
		</td>
		<td colspan="{{1}}" class="{{r.section}} text-right" ng-if="r.section=='kundeheader'">
		    
		</td>
		<td colspan="{{1}}" class="{{r.section}} text-right" ng-if="r.section=='kundeheader'">
		    <span ng-show="wahrung=='EUR'">{{
			r.summen.anerkannt_ausschuss_preis_eur
			+r.summen.anerkannt_nacharbeit_preis_eur
			+r.summen.dif_falsch_deklariert_preis_eur
			+r.summen.verpackung_preis_eur
			+r.summen.kreislauf_preis_eur
			+r.summen.pauschale_preis_eur|number:2
			}}</span>
		    <span ng-show="wahrung=='CZK'">{{
			r.summen.anerkannt_ausschuss_preis_czk
			+r.summen.anerkannt_nacharbeit_preis_czk
			+r.summen.dif_falsch_deklariert_preis_czk
			+r.summen.verpackung_preis_czk
			+r.summen.kreislauf_preis_czk
			+r.summen.pauschale_preis_czk|number:2
			}}</span>
		</td>
		<td colspan="{{1}}" class="{{r.section}} text-right" ng-if="r.section=='kundeheader'">
		    {{r.summen.abmahnungenbetrag}}
		</td>
		<td colspan="{{1}}" class="{{r.section}} text-right" ng-if="r.section=='kundeheader'">
		    
		</td>
		
		<!--rekldetail---------------------------------------------- -->
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}}" ng-if="r.section=='rekldetail'">
		    <a target="_blank" href="../reklamation/reklamation.php#/detail/{{r.rekl.id}}">{{r.rekl.rekl_nr}}</a><hr>
		    {{r.rekl.kd_rekl_nr}}
		</td>
		
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}}" ng-if="r.section=='rekldetail'">
		    {{r.rekl.export}}
		</td>
		
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}}" ng-if="r.section=='rekldetail'">
		    <div title="erhalten am">{{r.rekl.rekl_datum}}</div><hr>
		    <div title="erledigt am" style="position:absolute;">{{r.rekl.rekl_erledigt_am}}</div>
		</td>
		
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}}" ng-if="r.section=='rekldetail'">
		    {{r.rekl.beschr_abweichung}}
		</td>
		
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}}" ng-if="r.section=='rekldetail'">
		    {{r.rekl.beschr_ursache}}
		</td>
		
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}}" ng-if="r.section=='rekldetail'">
		    {{r.rekl.beschr_beseitigung}}
		</td>
		
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}}" ng-if="r.section=='rekldetail'">
		    <a target="_blank" href="../dkopf/dkopf.php?teil={{r.rekl.teil}}">{{r.rekl.teil}}</a><hr>
		    <div title="giesstag">{{r.rekl.giesstag}}</div>
		</td>
		
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}} text-right" ng-if="r.section=='rekldetail'">
		    {{r.rekl.stk_expediert}}
		</td>
		
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}} text-right" ng-if="r.section=='rekldetail'">
		    {{r.rekl.stk_reklammiert}}
		</td>
		
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}} text-right" ng-if="r.section=='rekldetail'">
		    {{r.rekl.interne_bewertung}}
		</td>
		
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}} text-right" ng-if="r.section=='rekldetail'">
		    <div title="Ausschuss" ng-show="r.rekl.anerkannt_stk_ausschuss!=0" class="row rowstk">
			<div class="col-xs-6 text-left">A</div>
			<div class="col-xs-6 text-right">{{r.rekl.anerkannt_stk_ausschuss}}</div>
		    </div>
		    <div title="Nacharbeit" ng-show="r.rekl.anerkannt_stk_nacharbeit!=0" class="row rowstk">
			<div class="col-xs-6 text-left">NA</div>
			<div class="col-xs-6 text-right">{{r.rekl.anerkannt_stk_nacharbeit}}</div>
		    </div>
		    <div title="Dif / falsch deklariert" ng-show="r.rekl.dif_falsch_deklariert_stk!=0" class="row rowstk">
			<div class="col-xs-6 text-left">Dif</div>
			<div class="col-xs-6 text-right">{{r.rekl.dif_falsch_deklariert_stk}}</div>
		    </div>
		    <div title="Verpackung" ng-show="r.rekl.verpackung_stk!=0" class="row rowstk">
			<div class="col-xs-6 text-left">VPA</div>
			<div class="col-xs-6 text-right">{{r.rekl.verpackung_stk}}</div>
		    </div>
		    <div title="Kreislauf" ng-show="r.rekl.kreislauf_stk!=0" class="row rowstk">
			<div class="col-xs-6 text-left">Mat</div>
			<div class="col-xs-6 text-right">{{r.rekl.kreislauf_stk}}</div>
		    </div>
		    <div title="Unklar" ng-show="r.rekl.unklar_stk!=0" class="row rowstk">
			<div class="col-xs-6 text-left">?</div>
			<div class="col-xs-6 text-right">{{r.rekl.unklar_stk}}</div>
		    </div>
		    <div title="nicht anerkannt" ng-show="r.rekl.anerkannt_stk_nein!=0" class="row">
			<div class="col-xs-6 text-left">
			    <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
			</div>
			<div class="col-xs-6 text-right">{{r.rekl.anerkannt_stk_nein}}</div>
		    </div>
		</td>
		
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}} text-right" ng-if="r.section=='rekldetail'">
		    <span ng-show="wahrung=='EUR'">{{
			r.rekl.anerkannt_ausschuss_preis_eur
			+r.rekl.anerkannt_nacharbeit_preis_eur
			+r.rekl.dif_falsch_deklariert_preis_eur
			+r.rekl.verpackung_preis_eur
			+r.rekl.kreislauf_preis_eur
			+r.rekl.pauschale_preis_eur|number:2
			}}</span>
		    <span ng-show="wahrung=='CZK'">{{
			r.rekl.anerkannt_ausschuss_preis_czk
			+r.rekl.anerkannt_nacharbeit_preis_czk
			+r.rekl.dif_falsch_deklariert_preis_czk
			+r.rekl.verpackung_preis_czk
			+r.rekl.kreislauf_preis_czk
			+r.rekl.pauschale_preis_czk|number:2
			}}</span>
		</td>
		
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}}  text-right" ng-if="r.section=='rekldetail'">
		    {{r.rekl.abmahnungenbetrag}}
		</td>
		
		<td  ng-show="(filter_nichterledigt&&r.rekl.rekl_erledigt_am=='')||(!filter_nichterledigt)" class="{{r.section}}" ng-if="r.section=='rekldetail'">
		    {{r.rekl.bemerkung}}
		</td>
		
		<!--tableSummen------------------------------------------------> 
		<td colspan="{{columns-5}}" class="{{r.section}}" ng-if="r.section=='tableSummen'">
		    Gesamtsumme
		</td>
		<td colspan="{{1}}" class="{{r.section}} text-right" ng-if="r.section=='tableSummen'">
		    {{r.summen.interne_bewertung}}
		</td>
		<td colspan="{{1}}" class="{{r.section}} text-right" ng-if="r.section=='tableSummen'">
		    
		</td>
		<td colspan="{{1}}" class="{{r.section}} text-right" ng-if="r.section=='tableSummen'">
		    <span ng-show="wahrung=='EUR'">{{
			r.summen.anerkannt_ausschuss_preis_eur
			+r.summen.anerkannt_nacharbeit_preis_eur
			+r.summen.dif_falsch_deklariert_preis_eur
			+r.summen.verpackung_preis_eur
			+r.summen.kreislauf_preis_eur
			+r.summen.pauschale_preis_eur|number:2
			}}</span>
		    <span ng-show="wahrung=='CZK'">{{
			r.summen.anerkannt_ausschuss_preis_czk
			+r.summen.anerkannt_nacharbeit_preis_czk
			+r.summen.dif_falsch_deklariert_preis_czk
			+r.summen.verpackung_preis_czk
			+r.summen.kreislauf_preis_czk
			+r.summen.pauschale_preis_czk|number:2
			}}</span>
		</td>
		<td colspan="{{1}}" class="{{r.section}} text-right" ng-if="r.section=='tableSummen'">
		    {{r.summen.abmahnungenbetrag}}
		</td>
		<td colspan="{{1}}" class="{{r.section}} text-right" ng-if="r.section=='tableSummen'">
		    
		</td>
	    </tr>
	</tbody>
	
	<tfoot>
	</tfoot>
    </table>
</div>
