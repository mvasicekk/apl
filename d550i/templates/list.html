<div id="spinner"></div>

<div class="container-fluid">
    <div class="page-header">
	<h4>D550 (interaktiv)</h4>
    </div>
    <table ng-init="columns=10" id='d550it' st-table="dZeilen" st-safe-src="zeilen" class="table table-bordered table-condensed table-hover">
	<thead>
	    <tr class="no-print">
		<th style="" colspan="{{1}}">
		    <input tabindex="1" style="width:8em;" class="form-control" ng-keypress="getZeilen($event)" maxlength="3" ng-model="kundeVon" placeholder="Kunde von" type="text"/>
		    <input tabindex="2" style="width:8em;" class="form-control" ng-keypress="getZeilen($event)" maxlength="3" ng-model="kundeBis" placeholder="Kunde bis" type="text"/>
		    <input tabindex="3" style="width:8em;" class="form-control" ng-keypress="getZeilen($event)" maxlength="10" ng-model="teilMatch" placeholder="Teil" type="text"/>
		</th>
		<th style="" colspan="{{1}}">
		    <input ng-model="datumVon" style="width:8em;" ui-date="dateOptions" type="text" class="form-control" id="" placeholder="von Datum">
		    <input ng-model="datumBis" style="width:8em;" ui-date="dateOptions" type="text" class="form-control" id="" placeholder="bis Datum">
		</th>
		<th colspan="{{columns-2}}">
		    <button class="btn btn-primary no-print" ng-click="showPrintDialog()">drucken</button>
		    <div class="checkbox-inline">
			<label class="checkbox-inline">
			    <input ng-model="mitImportDetail" type="checkbox">Importe zeigen
			</label>
		    </div>		    
		</th>
	    </tr>
	    <tr>
		<th style="width:8em;">IMA-Nr</th>
		<th style="width:8em;">EMA-Nr</th>
		<th style="width:4em;">Von</th>
		<th style="width:4em;">VzAby</th>
		<th style="width:4em;">VzKd</th>
		<th style="width:4em;" class="text-right">Stk gemeldet</th>
		<th style="width:4em;" class="text-right">Stk genehmigt</th>
		<th style="width:4em;" class="text-right">Stk(gut) bearbeitet</th>
		<th style="width:4em;" class="text-right">Stk(gut) berechnet</th>
		<th class="text-right">Rechnung</th>
	    </tr>
	</thead>
	<tbody ng-if="zeilen===null">
	    <tr>
		<td colspan="{{columns}}" class="text-center text-danger">
		    <h1>Keine Data !</h1>
		</td>
	    </tr>
	</tbody>
	<tbody>
	    <tr ng-repeat="r in dZeilen" ng-init="zeilenIndex = $index">
		<!--kunde header-->
		<td colspan="{{columns}}" class="{{r.section}}" ng-show="r.section=='kundeheader'">
		    {{r.kunde}}
		</td>
		
		<!--teil header-->
		<td colspan="{{columns}}" class="{{r.section}}" ng-show="r.section=='teilheader'">
		    <a target="_blank" href="../dkopf/dkopf.php?teil={{r.teil}}">{{r.teil}} - {{r.teilInfo.Teilbez}}</a>
		</td>

		<!--dma header-->
		<td  class="{{r.section}}" ng-show="r.section=='dmaheader'" ng-class="{ima_inarbeit:(r.dmaRow.ema_genehmigt==0&&r.dmaRow.ima_genehmigt==0),ima_genehmigt:r.dmaRow.ima_genehmigt>0,ima_nicht_genehmigt:r.dmaRow.ima_genehmigt<0}">
		    <strong>{{r.dmaRow.imanr}}</strong>
		</td>
		<td class="{{r.section}}" ng-show="r.section=='dmaheader'" ng-class="{ima_inarbeit:(r.dmaRow.ema_genehmigt==0&&r.dmaRow.ima_genehmigt==0),ima_genehmigt:r.dmaRow.ema_genehmigt>0,ima_nicht_genehmigt:r.dmaRow.ema_genehmigt<0}">
		    <strong>{{r.dmaRow.emanr}}</strong>
		</td>
		<td class="{{r.section}}" ng-show="r.section=='dmaheader'">
		    {{r.dmaRow.imavon}}
		</td>
		<td  style="" class="{{r.section}} text-right" ng-show="r.section=='dmaheader'">
		    VzAby
		</td>
		<td  style="" class="{{r.section}} text-right" ng-show="r.section=='dmaheader'">
		    VzKd
		</td>
		<td colspan="{{columns-5}}" class="{{r.section}}" ng-show="r.section=='dmaheader'">
		    {{r.dmaRow.bemerkung}}
		</td>

		<!--dma detail-->
		<td  colspan="2" class="{{r.section}}" ng-show="r.section=='dmadetail'" >
		</td>
		<td class="{{r.section}} text-right" ng-show="r.section=='dmadetail'">
		    {{r.tatzeitinfo.abgnr}}
		</td>
		<td class="{{r.section}} text-right" ng-show="r.section=='dmadetail'">
		    {{r.tatzeitinfo.vzaby|number:2}}
		</td>
		<td class="{{r.section}} text-right" ng-show="r.section=='dmadetail'">
		    {{r.tatzeitinfo.vzkd|number:2}}
		</td>
		<!--kusy gemeldet-->
		<td class="{{r.section}} text-right" ng-show="r.section=='dmadetail'">
		    <span title="IMA gemeldete Stk" ng-show="r.summen.ema_antrag===undefined">{{r.summen.ima_antrag.ba_stk}}</span>
		    <span title="EMA gemeldete Stk" ng-show="r.summen.ema_antrag!==undefined">{{r.summen.ema_antrag.ba_stk}}</span>
		</td>
		<!--kusy genehmigt-->
		<td class="{{r.section}} text-right" ng-show="r.section=='dmadetail'">
    		    <span title="IMA genehmigte Stk" ng-show="r.summen.ema_genehmigt===undefined">{{r.summen.ima_genehmigt.ba_stk}}</span>
		    <span title="EMA genehmigte Stk" ng-show="r.summen.ema_genehmigt!==undefined">{{r.summen.ema_genehmigt.ba_stk}}</span>
		</td>
		<!--kusy bearbeitet-->
		<td class="{{r.section}} text-right" ng-show="r.section=='dmadetail'">
		    <span title="i" ng-show="r.summen[r.tatzeitinfo.abgnr].ema_antrag===undefined">{{r.summen[r.tatzeitinfo.abgnr].ima_antrag.stk_bearbeitet}}</span>
		    <span title="e" ng-show="r.summen[r.tatzeitinfo.abgnr].ema_antrag!==undefined">{{r.summen[r.tatzeitinfo.abgnr].ema_antrag.stk_bearbeitet}}</span>
		</td>
		<!--kusy berechnet-->
		<td class="{{r.section}} text-right" ng-show="r.section=='dmadetail'">
		    <span title="i" ng-show="r.summen[r.tatzeitinfo.abgnr].ema_antrag===undefined">{{r.summen[r.tatzeitinfo.abgnr].ima_antrag.stk_berechnet}}</span>
		    <span title="e" ng-show="r.summen[r.tatzeitinfo.abgnr].ema_antrag!==undefined">{{r.summen[r.tatzeitinfo.abgnr].ema_antrag.stk_berechnet}}</span>
		</td>
		<!--rechnung-->
		<td class="{{r.section}}" ng-show="r.section=='dmadetail'">
		</td>

		<!--importabgnrdetail-->
		<td colspan="2" class="{{r.section}} text-right" ng-show="r.section=='importabgnrdetail' && mitImportDetail">
		    {{r.import}}
		</td>
		<td class="{{r.section}} text-right" ng-show="r.section=='importabgnrdetail' && mitImportDetail">
		    {{r.abgnr}}
		</td>
		<td colspan="2" class="{{r.section}}" ng-show="r.section=='importabgnrdetail' && mitImportDetail">
		    
		</td>

		<!--kusy gemeldet-->
		<td class="text-right" ng-show="r.section=='importabgnrdetail' && mitImportDetail">
		    <span title="IMA gemeldete Stk" ng-show="r.antragImportStk.stk.ema_antrag===undefined">{{r.antragImportStk.stk.ima_antrag.ba_stk}}</span>
		    <span title="EMA gemeldete Stk" ng-show="r.antragImportStk.stk.ema_antrag!==undefined">{{r.antragImportStk.stk.ema_antrag.ba_stk}}</span>
		    <!--{{r.antragImportStk.stk.ima_antrag.ba_stk}}(ba)-->
		</td>
		<!--kusy genehmigt-->
		<td class="text-right" ng-show="r.section=='importabgnrdetail' && mitImportDetail">
		    <span title="IMA genehmigte Stk" ng-show="r.antragImportStk.stk.ema_genehmigt===undefined">{{r.antragImportStk.stk.ima_genehmigt.ba_stk}}</span>
		    <span title="EMA genehmigte Stk" ng-show="r.antragImportStk.stk.ema_genehmigt!==undefined">{{r.antragImportStk.stk.ema_genehmigt.ba_stk}}</span>
		    <!--{{r.antragImportStk.ba_stk}}(ba)-->
		</td>
		<!--kusy bearbeitet-->
		<td class="text-right" ng-show="r.section=='importabgnrdetail' && mitImportDetail">
		    <span title="i" ng-show="r.stkArray.ema_antrag===undefined">{{r.stkArray.ima_antrag}}</span>
		    <span title="e" ng-show="r.stkArray.ema_antrag!==undefined">{{r.stkArray.ema_antrag}}</span>
		</td>
		<!--kusy berechnet-->
		<td class="text-right" ng-show="r.section=='importabgnrdetail' && mitImportDetail">
    		    <span title="i" ng-show="r.antragImportStk.stk_berechnet[r.abgnr].ema_antrag===undefined">{{r.antragImportStk.stk_berechnet[r.abgnr].ima_antrag}}</span>
		    <span title="e" ng-show="r.antragImportStk.stk_berechnet[r.abgnr].ema_antrag!==undefined">{{r.antragImportStk.stk_berechnet[r.abgnr].ema_antrag}}</span>
		</td>
		<!--rechnung-->
		<td class="text-right" ng-show="r.section=='importabgnrdetail' && mitImportDetail">
    		    <span title="i" ng-show="r.antragImportStk.rechnr[r.abgnr].ema_antrag===undefined">{{r.antragImportStk.rechnr[r.abgnr].ima_antrag}}</span>
		    <span title="e" ng-show="r.antragImportStk.rechnr[r.abgnr].ema_antrag!==undefined">{{r.antragImportStk.rechnr[r.abgnr].ema_antrag}}</span>
		</td>
		<!-------------------------------------------------------------------->
	    </tr>
	</tbody>
	
	<tfoot>
<!--	    <tr>
		<td colspan="{{5 + abgnrKeysArray.length + aartKeysArray.length}}" class="text-center">
		    <div st-pagination="true" st-items-by-page="50" st-displayed-pages="10"></div>
		</td>
	    </tr>-->
	</tfoot>
    </table>
</div>
